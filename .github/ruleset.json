{
  "rules": [
    {
      "id": "main-branch-protection",
      "enforcement": "active",
      "name": "Main Branch Protection",
      "target": "branch:main",
      "conditions": {
        "ref_name": {
          "include": ["refs/heads/main"],
          "exclude": []
        }
      },
      "rules": [
        {
          "type": "pull_request",
          "parameters": {
            "dismiss_stale_reviews_on_push": true,
            "require_code_owner_reviews": true,
            "require_last_push_approval": true,
            "required_approving_review_count": 1,
            "required_review_thread_resolution": true
          }
        },
        {
          "type": "required_status_checks",
          "parameters": {
            "strict_required_status_checks_policy": true,
            "required_status_checks": [
              { "context": "build" },
              { "context": "test" },
              { "context": "lint" }
            ]
          }
        },
        {
          "type": "required_linear_history"
        },
        {
          "type": "required_signatures"
        },
        {
          "type": "non_fast_forward"
        }
      ],
      "bypass_actors": [
        {
          "actor_id": 1,
          "actor_type": "RepositoryRole",
          "bypass_mode": "always"
        }
      ]
    },
    {
      "id": "develop-branch-protection",
      "enforcement": "active",
      "name": "Develop Branch Protection",
      "target": "branch:develop",
      "conditions": {
        "ref_name": {
          "include": ["refs/heads/develop"],
          "exclude": []
        }
      },
      "rules": [
        {
          "type": "pull_request",
          "parameters": {
            "dismiss_stale_reviews_on_push": true,
            "required_approving_review_count": 1,
            "required_review_thread_resolution": true
          }
        },
        {
          "type": "required_status_checks",
          "parameters": {
            "strict_required_status_checks_policy": true,
            "required_status_checks": [
              { "context": "build" },
              { "context": "test" }
            ]
          }
        }
      ],
      "bypass_actors": [
        {
          "actor_id": 1,
          "actor_type": "RepositoryRole",
          "bypass_mode": "always"
        }
      ]
    },
    {
      "id": "feature-branch-naming",
      "enforcement": "active",
      "name": "Feature Branch Naming Convention",
      "target": "branch",
      "conditions": {
        "ref_name": {
          "include": ["refs/heads/feature/*"],
          "exclude": []
        }
      },
      "rules": [
        {
          "type": "branch_name_pattern",
          "parameters": {
            "operator": "regex",
            "pattern": "^feature/[a-z0-9][a-z0-9-_/]+$"
          }
        }
      ]
    },
    {
      "id": "commit-message-pattern",
      "enforcement": "active",
      "name": "Commit Message Pattern",
      "target": "branch",
      "conditions": {
        "ref_name": {
          "include": ["refs/heads/main", "refs/heads/develop"],
          "exclude": []
        }
      },
      "rules": [
        {
          "type": "commit_message_pattern",
          "parameters": {
            "operator": "regex",
            "pattern": "^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\\([a-z0-9-_\\.]+\\))?!?: .+$"
          }
        }
      ],
      "bypass_actors": [
        {
          "actor_id": "dependabot",
          "actor_type": "Integration",
          "bypass_mode": "always"
        }
      ]
    }
  ]
}
